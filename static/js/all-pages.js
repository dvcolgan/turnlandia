// Generated by CoffeeScript 1.6.3
var ALL_PAGES, getParameterByName;

getParameterByName = function(name) {
  var regex, regexS, results;
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
  regexS = "[\\?&]" + name + "=([^&#]*)";
  regex = new RegExp(regexS);
  results = regex.exec(window.location.search);
  if (results === null) {
    return "";
  } else {
    return decodeURIComponent(results[1].replace(/\+/g, " "));
  }
};

ALL_PAGES = {
  home: function() {},
  create_account: function() {},
  messages: function() {},
  settings: function() {
    var settingsViewModel, startingColor;
    settingsViewModel = function() {
      var vm;
      vm = this;
      vm.leaderName = ko.observable($('#id_leader_name').val());
      vm.peopleName = ko.observable($('#id_people_name').val());
      vm.countryName = ko.observable($('#id_country_name').val());
      return null;
    };
    ko.applyBindings(new settingsViewModel);
    startingColor = $('#id_color').val() || '#ffffff';
    $('#id_color').css('background-color', startingColor).css('color', startingColor);
    $('#id_color').ColorPicker({
      color: startingColor,
      onShow: function(colpkr) {
        $(colpkr).fadeIn(100);
        return false;
      },
      onChange: function(hsb, hex, rgb) {
        return $('#id_color').val('#' + hex).css('background-color', '#' + hex).css('color', '#' + hex);
      },
      onHide: function(colpkr) {
        $(colpkr).fadeOut(100);
        return false;
      }
    });
    if (getParameterByName('color')) {
      $('#id_color').parents('.form-group').addClass('has-error');
    }
    if (getParameterByName('leader_name')) {
      $('#id_leader_name').parents('.form-group').addClass('has-error');
    }
    if (getParameterByName('people_name')) {
      return $('#id_people_name').parents('.form-group').addClass('has-error');
    }
  },
  game: function() {
    return TB.initialize();
  }
};

$(function() {
  var cl;
  $.ajaxSetup({
    crossDomain: false,
    beforeSend: function(xhr, settings) {
      if (!/^(GET|HEAD|OPTIONS|TRACE)$/.test(settings.type)) {
        return xhr.setRequestHeader("X-CSRFToken", $.cookie('csrftoken'));
      }
    }
  });
  cl = $('body').attr('class');
  if (cl && cl in ALL_PAGES) {
    return ALL_PAGES[cl]();
  }
});
