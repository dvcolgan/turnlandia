// Generated by CoffeeScript 1.6.3
var manage, request;

request = require('request');

manage = {
  clearSquares: function() {
    var url,
      _this = this;
    console.log('deleting old database');
    url = 'http://127.0.0.1:5984/turnbased_dev';
    return request({
      url: url,
      method: 'DELETE'
    }, function(error, response, body) {
      console.log('creating new database');
      url = 'http://127.0.0.1:5984/turnbased_dev';
      return request({
        url: url,
        method: 'PUT'
      }, function(error, response, body) {
        var designDoc;
        console.log('adding design document');
        designDoc = {
          _id: '_design/squares',
          'language': 'coffeescript',
          'views': {
            'get': {
              'map': '(doc) -> emit([doc.col, doc.row], doc)'
            }
          }
        };
        url = 'http://127.0.0.1:5984/turnbased_dev/_design/squares';
        return request({
          url: url,
          method: 'PUT',
          json: true,
          body: designDoc
        }, function(error, response, body) {
          return console.log('done');
        });
      });
    });
  }
};

manage[process.argv[2]]();
